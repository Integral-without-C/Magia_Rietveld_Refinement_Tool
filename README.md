========更新日志2025.12.11=========

优化了出错的判定逻辑

新增反问错误的判断

检测到[Max] Shift多次升高或多次相等时自动跳过当前步骤

新增阻塞检测功能，超过60秒未检测到新的[Max] Shift时自动跳过当前步骤

新增批量精修时为dat文件生成精修步骤概览报告AAA_step_overview.txt，包括精修耗时

！！！可以并行精修了！！！建议不超过3个线程，否则可能会因为磁盘IO过高导致阻塞，已优化效率

#######并行精修经过测试，无法较稳定运行，但保留此功能，建议使用单线程模式进行精修########


========更新日志2025.11.14=========

新增步骤超时自动跳过功能（超过500秒未完成的步骤会被自动跳过）

新增立即跳过当前步骤按钮，允许用户手动跳过当前正在运行的步骤

新增步骤概览标签页，实时显示每个步骤的状态、耗时和原因

新增批量处理功能，可以批量采用一个pcr对目录下多个dat文件进行精修




========更新日志2025.10.31=========

1.Magia_PCR_Reader_v1.1.py  可以直接一键识别原子名称了，但需要确保pcr中原子不能重名！

2.Magia_FP_Refinement_v1.1.py  新增调用PCR_check.py，检测精修后pcr中参数是否正常，例如B与OCC的值，异常则放弃该步骤精修结果，跳过该步骤。

3.新增PCR_check.py  其中允许用户设定每个原子的OCC取值合理阈值，还记得化学占有率与Fullprof占有率的区别在哪里吗？

4.Magia_Step_Genertor1.1.py GUI窗口优化，精修步骤独立窗口显示，原子参数类别优化分类，字体，背景优化


========Magia_Refinement_Toolbar_v1.0 使用说明===========

1.请先使用Fullprof_suite制作正确的pcr。

2.保证pcr位于全英文路径下，且pcr中的各项路径（dat路径、仪器路径）不含中文字符。

3.确保pcr中各个原子的名称不重名。（例如，有多个Cl6i时，需重名为Cl6i_1,Cl6i_2等）

4.如需采用该程序精修择优与不对称型参数，请先手动修改pcr中相关代码（AsyLim，Pr1 Pr2 Pr3等）。

5.先使用参数库生成，生成参数库文件（.JSON），然后使用步骤生成，生成步骤文件（.JSON），最后使用精修主控进行精修。

6.精修主控会自动搜索fp2k.exe文件，若未找到则需要手动指定。


===========参数库生成===============

可自动读取XRD与TOF，自动识别手动插入背底数目，自动识别编码格式并自动转换为UTF-8编码，自动检测是否存在“! Current global Chi2 (Bragg contrib.) = ”，不存在则自动生成。可更改字体大小。

###无法读取各向异性B值###


========步骤生成============

友好的GUI界面，允许用户批量设置步长，以及手动修改value值，允许Step步骤批量选中，进行复制与删除操作，允许外部导入参数库，具有一键全选/一键取消功能。

###新步骤仅能添加在末尾，不能在中间加入新的步骤，且不同Step之间无法互换位置###


==========精修主控============

自动搜索fp2k.exe执行文件，且允许用户手动指定。自动识别精修目录下.pcr与.dat文件（多个文件则需要手动滚轮选择）。主日志界面每100ms刷新，且仅保留最新100行数据，以提升性能。可暂停，但需等待当前Step结束后生效。自动检测精修中各类报错以及未收敛现象，记录并输出。


===================================

!!!注意：该程序完全免费，仅供学习与交流使用，禁止用于任何商业用途!!!

若有任何问题或建议，请联系开发者。
